@model IEnumerable<seniorDesign.Main_Database_For_Directory>

@{
    ViewBag.Title = "Table";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="jumbotron">
    <h2>Search</h2>
    <p class="lead">Search through list of providers.</p>
</div>

<p>
    @Html.ActionLink("Create New", "Create")
</p>
<div class="panel panel-primary">
    <!-- Default panel contents -->
    <div class="panel-heading" id="title">Directory of Providers</div>

    <div style="overflow: scroll; max-height: 360px;">
        <table id="myTable" class="table table-striped table-hover table-bordered">
            <tr>
                <th>Verify</th>
                <th>Organization Name</th>
                <th>Phone Number</th>
                <th>Email</th>
                <th>Street Address</th>
                <th>County</th>
                <th>Country</th>
                <th>Postal Code</th>
                <th>Services Offered</th>
                <th>Type</th>
                <th></th>
            </tr>
            <tr>
                <th></th>
                <th>
                    <div class="form-group has-feedback">
                        <input type="text" id="org" onkeyup="search(1)" class="form-control" />
                        <i class="glyphicon glyphicon-search form-control-feedback"></i>
                    </div>
                </th>
                <th>
                    <div class="form-group has-feedback">
                        <input type="text" id="phone" onkeyup="search(2)" class="form-control" />
                        <i class="glyphicon glyphicon-search form-control-feedback"></i>
                    </div>
                </th>
                <th>
                    <div class="form-group has-feedback">
                        <input type="text" id="email" onkeyup="search(3)" class="form-control" />
                        <i class="glyphicon glyphicon-search form-control-feedback"></i>
                    </div>
                </th>
                <th>
                    <div class="form-group has-feedback">
                        <input type="text" id="address" onkeyup="search(4)" class="form-control" />
                        <i class="glyphicon glyphicon-search form-control-feedback"></i>
                    </div>
                </th>
                <th>
                    <div class="form-group has-feedback">
                        <input type="text" id="county" onkeyup="search(5)" class="form-control" />
                        <i class="glyphicon glyphicon-search form-control-feedback"></i>
                    </div>
                </th>
                <th>
                    <div class="form-group has-feedback">
                        <input type="text" id="country" onkeyup="search(6)" class="form-control" />
                        <i class="glyphicon glyphicon-search form-control-feedback"></i>
                    </div>
                </th>
                <th>
                    <div class="form-group has-feedback">
                        <input type="text" id="postal" onkeyup="search(7)" class="form-control" />
                        <i class="glyphicon glyphicon-search form-control-feedback"></i>
                    </div>
                </th>
                
                <th>
                    <div class="form-group has-feedback">
                        <input type="text" id="services" onkeyup="search(8)" class="form-control" />
                        <i class="glyphicon glyphicon-search form-control-feedback"></i>
                    </div>
                </th>
                <th>
                    <div class="form-group has-feedback">
                        <input type="text" id="authority" onkeyup="search(9)" class="form-control" />
                        <i class="glyphicon glyphicon-search form-control-feedback"></i>
                    </div>
                </th>

            </tr>

            @foreach (var item in Model)
            {
                <tr>
                    <td>
                        <input type="button" class="btn btn-success" value="click" onclick="openModal()" />
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Organization)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PhoneNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Email)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.StreetAddress)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.County)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Country)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PostalCode)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.ServicesOffered)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.TypeOfOrginization)
                    </td>

                    <td>
                        @Html.ActionLink("Edit", "Edit", new { /* id=item.PrimaryKey */ }) |
                        @Html.ActionLink("Details", "Details", new { /* id=item.PrimaryKey */ }) |
                        @Html.ActionLink("Delete", "Delete", new { /* id=item.PrimaryKey */ })
                    </td>
                </tr>
            }

        </table>
        </div>
    </div>
<div class="modal fade" id="comments" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" style="margin-left: 7px" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title" id="commentTitle">Comments</h4>
            </div>
            <div class="modal-body">

                <ul class="list-group" id="listOfComments" style="overflow: scroll; max-height: 150px; width: 100%;">
                    <li class="list-group-item list-group-item-success"><p>The rating for this organization</p><small>organization</small></li>
                    <li class="list-group-item list-group-item-success"><p>The rating for this organization</p><small>organization</small></li>
                    <li class="list-group-item list-group-item-danger"><p>The rating for this organization</p><small>organization</small></li>
                    <li class="list-group-item list-group-item-success"><p>The rating for this organization</p><small>organization</small></li>
                </ul>
                <hr />
                <div style="background-color: #eeeeee; padding: 7px;">
                    <h4>Add a Comment:</h4>
                    <textarea class="form-control" rows="2" id="commentBox"></textarea>

                    <label for="commentName" style="padding-top:4px">Your Organization Name:</label>
                    <input class="form-control" id="commentName">
                    <label style="padding-top:4px">Rate: </label>
                    <br />

                    <button class="btn btn-default" id="likeBtn" onclick="chooseRating(0)"><b><span class="glyphicon glyphicon-thumbs-up"></span></b></button>
                    <button class="btn btn-default" id="dislikeBtn" onclick="chooseRating(1)"><b><span class="glyphicon glyphicon-thumbs-down"></span></b></button>
                    <br />
                    <br />
                    <button class="btn btn-default" style="margin-top: 5px">Add</button>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-danger" onclick="chooseRating(2)" data-dismiss="modal">Close</button>
            </div>
        </div>

    </div>
</div>	
<script>
    $(document).ready(function () {


        updateBadge();


    });
    function openModal() {
        $("#comments").modal('show');
    }
    function chooseRating(rating) {

        if (rating == 0) {
            $("#likeBtn").css({ "color": "white", "background-color": "#419641" });
            $("#dislikeBtn").css({ "color": "black", "background-color": "white" });
        }
        else if (rating == 1) {
            $("#dislikeBtn").css({ "color": "white", "background-color": "#c12e2a" });
            $("#likeBtn").css({ "color": "black", "background-color": "white" });
        }
        else if (rating == 2) {
            $("#dislikeBtn").css({ "color": "black", "background-color": "white" });
            $("#likeBtn").css({ "color": "black", "background-color": "white" });
        }
    }

    function updateBadge() {
        var table, tr;
        table = document.getElementById("myTable");
        tr = table.getElementsByTagName("tr");
        var i = tr.length - 2;
        $("#title").html('<span>Directory of Providers </span><span class="badge"> ' + i + '</span>');


        $("#commentTitle").html('<span>Comment </span><span style="float: right; font-size: 14px"> Verified by: <span class="badge">85%</span></span>');

    }
    function search(col) {

        var input, filter, table, tr, td, i;

        if (col == 1) {
            input = document.getElementById("org");
        }
        else if (col == 2){
            input = document.getElementById("phone");
        }
        else if (col == 3) {
            input = document.getElementById("email");
        }
        else if (col == 4) {
            input = document.getElementById("address");
        }
        else if (col == 5) {
            input = document.getElementById("county");
        }
        else if (col == 6) {
            input = document.getElementById("country");
        }
        else if (col == 7) {
            input = document.getElementById("postal");
        }
        else if (col == 8) {
            input = document.getElementById("services");
        }
        else if (col == 9) {
            input = document.getElementById("authority");
        }

        filter = input.value.toUpperCase();
        table = document.getElementById("myTable");
        tr = table.getElementsByTagName("tr");

        // Loop through all table rows, and hide those who don't match the search query
        for (i = 0; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td")[col];
            if (td) {
                if (td.innerHTML.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            }
        }

    }

</script>
